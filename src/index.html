<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Egg Application</title>
</head>
<body>
<h1>Egg Application</h1>

<!-- Log into Twitch Button -->
<button id="login-button">Log into Twitch</button>
<p id="status">Status: Not logged in</p>

<!-- Save State Button -->
<button id="save-state-button">Save Current State</button>

<script>
    const loginButton = document.getElementById('login-button');
    const statusText = document.getElementById('status');
    const saveStateButton = document.getElementById('save-state-button');

    loginButton.addEventListener('click', () => {
        console.log('Log into Twitch button clicked'); // Debugging log
        window.electronAPI.logIntoTwitch();
    });

    window.electronAPI.receiveLoginStatus((status) => {
        console.log('Received login status:', status);
        statusText.textContent = `Status: ${status}`;

        // Trigger EventSub WebSocket only if login is successful
        if (status.includes('Logged in')) {
            console.log('Starting Twitch EventSub...');
            window.electronAPI.startTwitchEventSub();
        }
    });

    saveStateButton.addEventListener('click', () => {
        console.log('Save State button clicked');
        window.electronAPI.saveState();
    });

    window.electronAPI.onStateSaved((message) => {
        console.log(message);
        alert(message); // Notify the user that the state has been saved
    });
</script>
</body>
</html>